<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>YANA — Scooty & Battery Masterlist</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
  <!-- Navbar matching dashboard -->
  <div class="navbar">
    <h2>⚡ YANA Admin</h2>
    <div class="profile">
      <div class="profile-pic">A</div>
      <div class="dropdown">
        <button onclick="location.href='admin-dashboard.html'">⬅ Dashboard</button>
        <button id="logoutBtn">Logout</button>
      </div>
    </div>
  </div>

  <div class="container">
    <h2>Scooty & Battery Masterlist</h2>
    <p class="muted">View state/status of assets. Read-only mode.</p>

    <!-- Tabs -->
    <div style="display:flex; gap:8px; margin-bottom:12px;">
      <button class="menu-btn ripple" id="scootyTab">Scooties</button>
      <button class="menu-btn ripple" id="batteryTab">Batteries</button>
    </div>

    <!-- Scooty Cards -->
    <div id="scootySection" class="tab-section">
      <input type="text" id="scootySearch" placeholder="Search Scooties..." style="width:100%;padding:8px;border-radius:var(--radius);margin-bottom:12px;background:var(--bg2);color:var(--text);border:1px solid var(--border);">
      <div id="scootyCards" class="grid-4"></div>
    </div>

    <!-- Battery Cards -->
    <div id="batterySection" class="tab-section" style="display:none;">
      <input type="text" id="batterySearch" placeholder="Search Batteries..." style="width:100%;padding:8px;border-radius:var(--radius);margin-bottom:12px;background:var(--bg2);color:var(--text);border:1px solid var(--border);">
      <div id="batteryCards" class="grid-4"></div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="firebase-config.js"></script>

  <script>
    // Auth check and profile pic
    auth.onAuthStateChanged(async user => {
      if(!user) location.href="admin-signin.html";
      const doc = await db.collection("users").doc(user.email).get();
      if(!doc.exists || doc.data().role!=="admin") { alert("❌ Not an admin."); location.href="index.html"; }
      document.querySelector(".profile-pic").innerText = (user.email[0] || "A").toUpperCase();
    });
    document.getElementById("logoutBtn").onclick = () => auth.signOut();

    const scootyCards = document.getElementById("scootyCards");
    const batteryCards = document.getElementById("batteryCards");

    // Render cards
    function renderCards(collection, container) {
      db.collection(collection).onSnapshot(snapshot => {
        container.innerHTML = "";
        snapshot.forEach(doc => {
          const d = doc.data();
          const card = document.createElement("div");
          card.className = "panel";
          card.innerHTML = `
            <h3>${doc.id}</h3>
            <p><strong>State:</strong> ${d.state || "-"}</p>
            <p><strong>Status:</strong> ${d.status || "-"}</p>
            <p><strong>Assigned To:</strong> ${d.assignedName || "-"}</p>
          `;
          container.appendChild(card);
        });
      });
    }

    renderCards("scooty_master", scootyCards);
    renderCards("battery_master", batteryCards);

    // Tab switching
    const scootySection = document.getElementById("scootySection");
    const batterySection = document.getElementById("batterySection");
    document.getElementById("scootyTab").onclick = () => {
      scootySection.style.display = "block";
      batterySection.style.display = "none";
    };
    document.getElementById("batteryTab").onclick = () => {
      scootySection.style.display = "none";
      batterySection.style.display = "block";
    };

    // Search functionality
    document.getElementById("scootySearch").addEventListener("input", e => {
      const q = e.target.value.toLowerCase();
      scootyCards.querySelectorAll(".panel").forEach(card => {
        card.style.display = card.querySelector("h3").textContent.toLowerCase().includes(q) ? "block" : "none";
      });
    });
    document.getElementById("batterySearch").addEventListener("input", e => {
      const q = e.target.value.toLowerCase();
      batteryCards.querySelectorAll(".panel").forEach(card => {
        card.style.display = card.querySelector("h3").textContent.toLowerCase().includes(q) ? "block" : "none";
      });
    });
  </script>
</body>
</html>

